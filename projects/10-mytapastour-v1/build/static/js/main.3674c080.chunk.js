(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){e.exports=a(34)},18:function(e,t,a){},28:function(e,t,a){},30:function(e,t,a){e.exports=a.p+"static/media/powered-by-foursquare-grey.cdd335d8.png"},34:function(e,t,a){"use strict";a.r(t);a(18),a(20),a(22);var n,o=a(0),c=a.n(o),r=a(14),s=a.n(r),i=a(35),l=a(3),u=a(4),m=a(6),d=a(5),p=a(7),h=a(36),f=a(11),g=a.n(f),v=(a(28),"XN3KVA302HH1TJ2P1OPH3WUWKGRXVKMX2NWNPQBTXOZSKPPC"),w="JX2GROLYRGSEKWBDR5X5MITPUUZAH3NEL5BLKYGTF5RBT5IA",b="AIzaSyCEhfBMzJxAaTKLtp8GjcVwEZobHckXXis",y=function(e){var t=new Headers,a={method:"GET",headers:t,mode:"cors",cache:"default"};return t.append("Accept-Language","en"),fetch("".concat("https://api.foursquare.com/v2/venues/search?","client_id=").concat(w,"&client_secret=").concat(v,"&v=").concat("20181204","&limit=").concat("50","&intent=browse&ll=").concat(e.lat,",").concat(e.lng,"&radius=2000&categoryId=").concat("4d4b7105d754a06374d81259"),a).then(function(e){if(e.ok)return e.json();throw new Error("Network response was not OK on getSearch() request. Status: ".concat(e.status))})},E=function(e){var t=e.map(function(e){return fetch("".concat("https://api.foursquare.com/v2").concat("/venues","/").concat(e,"/photos?client_id=").concat(w,"&client_secret=").concat(v,"&v=").concat("20181204"))});return Promise.all(t).then(function(e){return e.map(function(e){return e.json()})})},N=function(e,t){var a=new RegExp(g()(e),"i"),n="https://api.foursquare.com/v2/venues/search?client_id=".concat(w,"&client_secret=").concat(v,"&v=").concat("20181204","&limit=").concat("50","&intent=browse&ll=").concat(t.lat,",").concat(t.lng,"&radius=10000&categoryId=").concat("4d4b7105d754a06374d81259","&query=").concat(a),o=new Headers,c={method:"GET",headers:o,mode:"cors",cache:"default"};return o.append("Accept-Language","en"),fetch(n,c).then(function(e){if(e.ok)return e.json();throw new Error("Network response was not OK on getQuery() request. Status: ".concat(e.status))})},k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).updateQuery=function(e){a.setState({query:e.target.value})},a.onKeyPress=function(e){"Enter"===e.key&&a.searchApi()},a.searchApi=function(){a.state.query?N(a.state.query,a.props.location).then(function(e){a.props.update(e.response.venues,a.state.query)}).catch(function(e){alert(e.message)}):y(a.props.location).then(function(e){a.props.update(e.response.venues,a.state.query)}).catch(function(e){alert(e.message)})},a.state={query:""},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"search-menu"},c.a.createElement("div",{className:"search-book-bar"},c.a.createElement("div",{className:"form-group"},c.a.createElement("input",{className:"form-control",type:"search",value:this.state.query,onKeyPress:this.onKeyPress,onChange:function(t){return e.updateQuery(t)},placeholder:"Search by venue name...","aria-label":"Search by venue name"})),c.a.createElement("img",{className:"float-right",src:a(30),height:"10",alt:""})))}}]),t}(o.Component),S=a(10),I=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).getVenuePhoto=function(e){if(e.photos&&e.photos.photo_res.length>0){var t=e.photos.photo_res[0].prefix,a=e.photos.photo_res[0].suffix;return"".concat(t,"300x300").concat(a)}return"https://via.placeholder.com/300"},a.getVenueIcon=function(e){if(e.categories[0].icon){var t=e.categories[0].icon.prefix,a=e.categories[0].icon.suffix;return"".concat(t,"bg_120").concat(a)}return"https://via.placeholder.com/300"},a.isRecommended=function(e){return e&&0===e.length?c.a.createElement("li",{key:0,className:"card text-center"},c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title pt-3"},"Sorry no results for your search!"),c.a.createElement("p",{className:"font-weight-normal"},"...maybe try something else?"))):a.props.recommend?e&&e.length>0&&e.map(function(e){return c.a.createElement("li",{key:e.referralId,className:"card",onClick:a.handleSelection.bind(Object(S.a)(Object(S.a)(a))),"data-id":e.venue.id,tabIndex:"0",id:e.venue.id},c.a.createElement("div",{className:"card-body"},c.a.createElement("img",{className:"photo rounded float-left img-fluid",src:a.getVenuePhoto(e),alt:"".concat(e.venue.name),width:"300",height:"300"}),c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title mb-1"},e.venue.name),c.a.createElement("p",{className:"font-weight-normal mb-0"},"Address: ",e.venue.location.address),c.a.createElement("p",{className:"font-weight-light mb-0"},"Category: ",e.venue.categories[0].name),c.a.createElement("p",{className:"font-weight-light font-italic mb-0"}," ",e.reasons.items[0].summary))))}):e&&e.length>0&&e.map(function(e){return c.a.createElement("li",{key:e.id,className:"card",onClick:a.handleSelection.bind(Object(S.a)(Object(S.a)(a))),"data-id":e.id,tabIndex:"0",id:e.id},c.a.createElement("div",{className:"card-body"},c.a.createElement("img",{className:"photo rounded float-left img-fluid",src:a.getVenueIcon(e),alt:"Icon of ".concat(e.name),width:"300",height:"300"}),c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title mb-1"},e.name),c.a.createElement("p",{className:"font-weight-normal mb-0"},"Address: ",e.location.address),c.a.createElement("p",{className:"font-weight-light mb-0"},"Category: ",e.categories[0].name))))})},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleSelection",value:function(e){this.props.onCheckedId(e.currentTarget.dataset.id)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props.tapas;return c.a.createElement("div",{className:""},c.a.createElement("div",{className:"list-container"},c.a.createElement("ul",{className:"list-group"},this.isRecommended(e))))}}]),t}(o.Component),O=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).fetchGoogleMaps=function(){fetch("https://maps.googleapis.com/maps/api/js?key=".concat(b),{}).then(function(e){if(e.ok)return e;throw new Error("My promise error, response: ".concat(e))})},a.populateInfoWindow=function(e,t,n){e.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1e3),e.setIcon(e.mIcon),t.marker=e,t.setContent('<div class="text-center"><p class="mb-1">'.concat(e.title,"</p><small>").concat(e.category,"</small></div>")),t.open(n,e);var o=document.getElementsByClassName("highlight");o&&o.length>0&&Array.prototype.map.call(o,function(e){return e.classList.remove("highlight")}),document.getElementById(e.id).classList.add("highlight"),t.addListener("closeclick",function(){e.setIcon(null),t.marker=null,a.props.handleInfoClose(e.id);var n=document.getElementById(e.id);n&&n.classList.remove("highlight")})},a.state={mapIsReady:!1,map:"",infoWindow:"",center:{lat:50.12187,lng:8.68955}},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"getGoogleMaps",value:function(){return this.googleMapsPromise||(this.googleMapsPromise=new Promise(function(e,t){window.resolveGoogleMapsPromise=function(){e(window.google),delete window.resolveGoogleMapsPromise};var a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=".concat(b,"&callback=resolveGoogleMapsPromise"),a.async=!0,a.defer=!0,a.onerror=function(e){return t(e)},document.body.appendChild(a)})),this.googleMapsPromise}},{key:"addMapMarkers",value:function(){var e=this,t=this.props,a=t.tapas,n=t.recommend,o=this.state,c=o.map,r=o.infoWindow;if(window.google){var s=new window.google.maps.LatLngBounds;return a.map(function(t){var a;a=n?t.venue:t;var o=new window.google.maps.Marker({map:c,position:{lat:a.location.lat,lng:a.location.lng},title:a.name,id:a.id,category:a.categories[0].name,mIcon:"".concat(a.categories[0].icon.prefix,"bg_32").concat(a.categories[0].icon.suffix)});return o.addListener("click",function(){r.marker!==o&&e.populateInfoWindow(o,r,c)}),s.extend(o.position),o})}}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.getGoogleMaps().then(function(t){return{map:new t.maps.Map(document.getElementById("map"),{zoom:13,center:e.state.center,mapTypeControl:!1}),window:new t.maps.InfoWindow}}).then(function(t){e.setState({mapIsRead:!0,map:t.map,infoWindow:t.window})}).catch(function(e){alert("Error with Google Maps API. Reason: ".concat(e))})}},{key:"componentDidUpdate",value:function(){var e=this.props.checkedId,t=this.state,a=t.map,o=t.infoWindow;if(o.marker&&o.close(),n&&n.map(function(e){e.setMap(null)}),n=this.addMapMarkers())for(var c=0;c<n.length;c++)n[c].id===e&&this.populateInfoWindow(n[c],o,a)}},{key:"render",value:function(){return c.a.createElement("div",{style:{height:"88vh",width:"100%"}},c.a.createElement("div",{id:"map",style:{height:"100%",width:"100%"}}))}}]),t}(o.Component),j=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).chooseNumber=function(e,t){t.preventDefault(),a.props.onNumberUpdate(e)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("button",{className:"dropdown-item",onClick:function(t){return e.chooseNumber("".concat(e.props.items),t)}},this.props.items," items")}}]),t}(o.Component),C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).loadButtons=function(){var e,t=a.props.onNumberUpdate,n=a.props.tapas.length;switch(!0){case n<11:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(j,{items:a.props.tapasShown.length,onNumberUpdate:t}));break;case n<21:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(j,{items:10,onNumberUpdate:t}),c.a.createElement(j,{items:a.props.tapas.length,onNumberUpdate:t}));break;case n<31:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(j,{items:10,onNumberUpdate:t}),c.a.createElement(j,{items:20,onNumberUpdate:t}),c.a.createElement(j,{items:a.props.tapas.length,onNumberUpdate:t}));break;case n<41:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(j,{items:10,onNumberUpdate:t}),c.a.createElement(j,{items:20,onNumberUpdate:t}),c.a.createElement(j,{items:30,onNumberUpdate:t}),c.a.createElement(j,{items:a.props.tapas.length,onNumberUpdate:t}));break;case n<51:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(j,{items:10,onNumberUpdate:t}),c.a.createElement(j,{items:20,onNumberUpdate:t}),c.a.createElement(j,{items:30,onNumberUpdate:t}),c.a.createElement(j,{items:40,onNumberUpdate:t}),c.a.createElement(j,{items:a.props.tapas.length,onNumberUpdate:t}));break;default:console.log("Sorry, we are out of "+n+".")}return e},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"search-menu"},c.a.createElement("div",{className:"btn-group"},c.a.createElement("button",{type:"button",className:"btn btn-secondary"},"Showing ",this.props.tapasShown.length||"0"," results"),c.a.createElement("button",{type:"button",className:"btn btn-secondary dropdown-toggle dropdown-toggle-split","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},c.a.createElement("span",{className:"sr-only"},"Toggle Results Dropdown")),this.loadButtons()))}}]),t}(o.Component),U=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).addPhotos=function(){var e,t=JSON.parse(JSON.stringify(a.state.tapas));a.state.tapas&&(e=a.state.tapas.map(function(e){return(a.state.recommend?e.venue:e).id}),E(e).then(function(a){a.map(function(a,n){return a.then(function(a){t[n].photos={id:e[n],photo_res:a.response.photos.items}})})}).then(function(){a.setState({tapas:t})}))},a.updateRecommendation=function(){a.state.recommend?a.setState({recommend:!1}):a.setState({recommend:!0})},a.updateResults=function(e,t){var n=a.cleanSearchResults(e,t),o=a.shortenResults(n,a.state.showLength);a.setState({tapas:n,tapasShown:o})},a.updateTapasShown=function(e){if(e!==a.state.showLength){var t=a.state.tapas.slice(0,e);a.setState({tapasShown:t,showLength:e})}},a.cleanSearchResults=function(e,t){return e.filter(function(e){if(e.location.address){var a=new RegExp(g()(t),"i");if(a.test(e.name)||a.test(e.categories[0].name)||a.test(e.categories[0].pluralName)||a.test(e.categories[0].shortName))return e}})},a.shortenResults=function(e,t){return e.slice(0,t)},a.handleCheck=function(e){var t=document.getElementsByClassName("highlight");t&&t.length>0&&Array.prototype.map.call(t,function(e){return e.classList.remove("highlight")}),a.state.checkedId!==e?document.getElementById(e).classList.add("highlight"):e="",a.setState({checkedId:e})},a.infoClosed=function(e){e===a.state.checkedId&&(document.getElementById(a.state.checkedId)&&document.getElementById(a.state.checkedId).classList.remove("highlight"),a.setState({checkedId:""}))},a.state={query:"",tapas:[],tapasShown:[],showLength:10,location:{lat:50.12187,lng:8.68955},checkedId:"",recommend:!1,mapKey:0},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.state.recommend?function(e){var t=new Headers,a={method:"GET",headers:t,mode:"cors",cache:"default"};return t.append("Accept-Language","en"),fetch("".concat("https://api.foursquare.com/v2/venues/explore?","client_id=").concat(w,"&client_secret=").concat(v,"&v=").concat("20181204","&limit=").concat("50","&intent=browse&ll=").concat(e.lat,",").concat(e.lng,"&categoryId=").concat("4d4b7105d754a06374d81259"),a).then(function(e){if(e.ok)return e.json();throw new Error("Network response was not OK on getBest() request. Status: ".concat(e.status))})}(this.state.location).then(function(t){e.setState({tapas:t.response.groups[0].items},function(){e.addPhotos()})}).catch(function(e){alert(e.message)}):y(this.state.location).then(function(t){e.setState({tapas:t.response.venues,tapasShown:e.shortenResults(t.response.venues,e.state.showLength)})}).catch(function(e){alert(e.message)})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement(h.a,{exact:!0,path:"/",render:function(){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement(k,{location:e.state.location,update:e.updateResults}),c.a.createElement(C,{tapas:e.state.tapas,tapasShown:e.state.tapasShown,onNumberUpdate:e.updateTapasShown}),c.a.createElement(I,{recommend:e.state.recommend,tapas:e.state.tapasShown,onCheckedId:e.handleCheck})),c.a.createElement("div",{className:"map-container col-12 col-md-6",role:"application","aria-label":"Filtered venue locations"},c.a.createElement(O,{key:e.state.mapKey,recommend:e.state.recommend,tapas:e.state.tapasShown,checkedId:e.state.checkedId,handleInfoClose:e.infoClosed})))}}))}}]),t}(o.Component),A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(c.a.createElement(i.a,null,c.a.createElement(U,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");A?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):M(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):M(t,e)})}}()}},[[17,2,1]]]);
//# sourceMappingURL=main.3674c080.chunk.js.map