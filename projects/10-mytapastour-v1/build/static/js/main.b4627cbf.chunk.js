(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,n){e.exports=n(34)},18:function(e,t,n){},28:function(e,t,n){},30:function(e,t,n){e.exports=n.p+"static/media/powered-by-foursquare-grey.cdd335d8.png"},34:function(e,t,n){"use strict";n.r(t);n(18),n(20),n(22);var a,o=n(0),c=n.n(o),r=n(14),s=n.n(r),i=n(35),l=n(3),u=n(4),m=n(6),d=n(5),p=n(7),h=n(36),f=(n(28),n(11)),g=n.n(f),v="XN3KVA302HH1TJ2P1OPH3WUWKGRXVKMX2NWNPQBTXOZSKPPC",b="JX2GROLYRGSEKWBDR5X5MITPUUZAH3NEL5BLKYGTF5RBT5IA",w=function(e){var t=new Headers,n={method:"GET",headers:t,mode:"cors",cache:"default"};return t.append("Accept-Language","en"),fetch("".concat("https://api.foursquare.com/v2/venues/search?","client_id=").concat(b,"&client_secret=").concat(v,"&v=").concat("20181204","&limit=").concat("50","&intent=browse&ll=").concat(e.lat,",").concat(e.lng,"&radius=2000&categoryId=").concat("4d4b7105d754a06374d81259"),n).then(function(e){return e.json()}).catch(function(e){console.log("getSearch error, ",e)})},y=function(e){var t=e.map(function(e){return fetch("".concat("https://api.foursquare.com/v2").concat("/venues","/").concat(e,"/photos?client_id=").concat(b,"&client_secret=").concat(v,"&v=").concat("20181204"))});return Promise.all(t).then(function(e){return e.map(function(e){return e.json()})})},E=function(e,t){var n=new RegExp(g()(e),"i"),a="https://api.foursquare.com/v2/venues/search?client_id=".concat(b,"&client_secret=").concat(v,"&v=").concat("20181204","&limit=").concat("50","&intent=browse&ll=").concat(t.lat,",").concat(t.lng,"&radius=10000&categoryId=").concat("4d4b7105d754a06374d81259","&query=").concat(n),o=new Headers,c={method:"GET",headers:o,mode:"cors",cache:"default"};return o.append("Accept-Language","en"),fetch(a,c).then(function(e){return e.json()}).catch(function(e){console.log("Error on getQuery: ",e)})},N=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).updateQuery=function(e){n.setState({query:e.target.value})},n.onKeyPress=function(e){"Enter"===e.key&&n.searchApi()},n.searchApi=function(){n.state.query?E(n.state.query,n.props.location).then(function(e){n.props.update(e.response.venues,n.state.query)}):w(n.props.location).then(function(e){n.props.update(e.response.venues,n.state.query)})},n.state={query:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"search-menu"},c.a.createElement("div",{className:"search-book-bar"},c.a.createElement("div",{className:"form-group"},c.a.createElement("input",{className:"form-control",type:"search",value:this.state.query,onKeyPress:this.onKeyPress,onChange:function(t){return e.updateQuery(t)},placeholder:"Search by venue name...","aria-label":"Search by venue name"})),c.a.createElement("img",{className:"float-right",src:n(30),height:"10",alt:""})))}}]),t}(o.Component),k=n(8),j=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).getVenuePhoto=function(e){if(e.photos&&e.photos.photo_res.length>0){var t=e.photos.photo_res[0].prefix,n=e.photos.photo_res[0].suffix;return"".concat(t,"300x300").concat(n)}return"https://via.placeholder.com/300"},n.getVenueIcon=function(e){if(e.categories[0].icon){var t=e.categories[0].icon.prefix,n=e.categories[0].icon.suffix;return"".concat(t,"bg_120").concat(n)}return"https://via.placeholder.com/300"},n.isRecommended=function(e){return e&&0===e.length?c.a.createElement("li",{key:0,className:"card text-center"},c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title pt-3"},"Sorry no results for your search!"),c.a.createElement("p",{className:"font-weight-normal"},"...maybe try something else?"))):n.props.recommend?e&&e.length>0&&e.map(function(e){return c.a.createElement("li",{key:e.referralId,className:"card",onClick:n.handleSelection.bind(Object(k.a)(Object(k.a)(n))),"data-id":e.venue.id,tabIndex:"0",id:e.venue.id},c.a.createElement("div",{className:"card-body"},c.a.createElement("img",{className:"photo rounded float-left img-fluid",src:n.getVenuePhoto(e),alt:"".concat(e.venue.name),width:"300",height:"300"}),c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title mb-1"},e.venue.name),c.a.createElement("p",{className:"font-weight-normal mb-0"},"Address: ",e.venue.location.address),c.a.createElement("p",{className:"font-weight-light mb-0"},"Category: ",e.venue.categories[0].name),c.a.createElement("p",{className:"font-weight-light font-italic mb-0"}," ",e.reasons.items[0].summary))))}):e&&e.length>0&&e.map(function(e){return c.a.createElement("li",{key:e.id,className:"card",onClick:n.handleSelection.bind(Object(k.a)(Object(k.a)(n))),"data-id":e.id,tabIndex:"0",id:e.id},c.a.createElement("div",{className:"card-body"},c.a.createElement("img",{className:"photo rounded float-left img-fluid",src:n.getVenueIcon(e),alt:"Icon of ".concat(e.name),width:"300",height:"300"}),c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title mb-1"},e.name),c.a.createElement("p",{className:"font-weight-normal mb-0"},"Address: ",e.location.address),c.a.createElement("p",{className:"font-weight-light mb-0"},"Category: ",e.categories[0].name))))})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleSelection",value:function(e){this.props.onCheckedId(e.currentTarget.dataset.id)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props.tapas;return c.a.createElement("div",{className:""},c.a.createElement("div",{className:"list-container"},c.a.createElement("ul",{className:"list-group"},this.isRecommended(e))))}}]),t}(o.Component),I=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).populateInfoWindow=function(e,t,a){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1e3),e.setIcon(e.mIcon),t.marker=e,t.setContent('<div class="text-center"><p class="mb-1">'.concat(e.title,"</p><small>").concat(e.category,"</small></div>")),t.open(a,e);var o=document.getElementsByClassName("highlight");o&&o.length>0&&Array.prototype.map.call(o,function(e){return e.classList.remove("highlight")}),document.getElementById(e.id).classList.add("highlight"),t.addListener("closeclick",function(){e.setIcon(null),t.marker=null,n.props.handleInfoClose(e.id);var a=document.getElementById(e.id);a&&a.classList.remove("highlight")})},n.state={mapIsReady:!1,map:"",infoWindow:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"getGoogleMaps",value:function(){return this.googleMapsPromise||(this.googleMapsPromise=new Promise(function(e){window.resolveGoogleMapsPromise=function(){e(google),delete window.resolveGoogleMapsPromise};var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCEhfBMzJxAaTKLtp8GjcVwEZobHckXXis","&callback=resolveGoogleMapsPromise"),t.async=!0,document.body.appendChild(t)})),this.googleMapsPromise}},{key:"addMapMarkers",value:function(){var e=this,t=this.props,n=t.tapas,a=t.recommend,o=this.state,c=o.map,r=o.infoWindow,s=new google.maps.LatLngBounds;return n.map(function(t){var n;n=a?t.venue:t;var o=new google.maps.Marker({map:c,position:{lat:n.location.lat,lng:n.location.lng},title:n.name,id:n.id,category:n.categories[0].name,mIcon:"".concat(n.categories[0].icon.prefix,"bg_32").concat(n.categories[0].icon.suffix)});return o.addListener("click",function(){r.marker!==o&&e.populateInfoWindow(o,r,c)}),s.extend(o.position),o})}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.getGoogleMaps().then(function(e){return{map:new e.maps.Map(document.getElementById("map"),{zoom:13,center:{lat:50.12187,lng:8.68955},mapTypeControl:!1}),window:new e.maps.InfoWindow}}).then(function(t){e.setState({map:t.map,infoWindow:t.window})})}},{key:"componentDidUpdate",value:function(){var e=this.props.checkedId,t=this.state,n=t.map,o=t.infoWindow;o.marker&&o.close(),a&&a.map(function(e){e.setMap(null)}),a=this.addMapMarkers();for(var c=0;c<a.length;c++)a[c].id===e&&this.populateInfoWindow(a[c],o,n)}},{key:"render",value:function(){return c.a.createElement("div",{style:{height:"88vh",width:"100%"}},c.a.createElement("div",{id:"map",style:{height:"100%",width:"100%"},role:"application","aria-label":"Filtered venue locations"}))}}]),t}(o.Component),S=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).chooseNumber=function(e,t){t.preventDefault(),console.log(t),n.props.onNumberUpdate(e)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("button",{className:"dropdown-item",onClick:function(t){return e.chooseNumber("".concat(e.props.items),t)}},this.props.items," items")}}]),t}(o.Component),O=(o.Component,function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).loadButtons=function(){var e,t=n.props.onNumberUpdate,a=n.props.tapas.length;switch(console.log("loading buttons"),!0){case a<11:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(S,{items:n.props.tapasShown.length,onNumberUpdate:t}));break;case a<21:console.log("less than 21"),e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(S,{items:10,onNumberUpdate:t}),c.a.createElement(S,{items:n.props.tapas.length,onNumberUpdate:t}));break;case a<31:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(S,{items:10,onNumberUpdate:t}),c.a.createElement(S,{items:20,onNumberUpdate:t}),c.a.createElement(S,{items:n.props.tapas.length,onNumberUpdate:t}));break;case a<41:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(S,{items:10,onNumberUpdate:t}),c.a.createElement(S,{items:20,onNumberUpdate:t}),c.a.createElement(S,{items:30,onNumberUpdate:t}),c.a.createElement(S,{items:n.props.tapas.length,onNumberUpdate:t}));break;case a<51:e=c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement(S,{items:10,onNumberUpdate:t}),c.a.createElement(S,{items:20,onNumberUpdate:t}),c.a.createElement(S,{items:30,onNumberUpdate:t}),c.a.createElement(S,{items:40,onNumberUpdate:t}),c.a.createElement(S,{items:n.props.tapas.length,onNumberUpdate:t}));break;default:console.log("Sorry, we are out of "+a+".")}return e},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"search-menu"},c.a.createElement("div",{className:"btn-group"},c.a.createElement("button",{type:"button",className:"btn btn-secondary"},"Showing ",this.props.tapasShown.length||"0"," results"),c.a.createElement("button",{type:"button",className:"btn btn-secondary dropdown-toggle dropdown-toggle-split","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},c.a.createElement("span",{className:"sr-only"},"Toggle Results Dropdown")),this.loadButtons()))}}]),t}(o.Component)),C=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).addPhotos=function(){var e,t=JSON.parse(JSON.stringify(n.state.tapas));n.state.tapas&&(e=n.state.tapas.map(function(e){return(n.state.recommend?e.venue:e).id}),y(e).then(function(n){n.map(function(n,a){return n.then(function(n){t[a].photos={id:e[a],photo_res:n.response.photos.items}})})}).then(function(){n.setState({tapas:t})}))},n.updateRecommendation=function(){n.state.recommend?n.setState({recommend:!1}):n.setState({recommend:!0})},n.updateResults=function(e,t){var a=n.cleanSearchResults(e,t),o=n.shortenResults(a,n.state.showLength);n.setState({tapas:a,tapasShown:o})},n.updateTapasShown=function(e){if(e!==n.state.showLength){var t=n.state.tapas.slice(0,e);n.setState({tapasShown:t,showLength:e})}},n.cleanSearchResults=function(e,t){return e.filter(function(e){if(e.location.address){var n=new RegExp(g()(t),"i");if(n.test(e.name)||n.test(e.categories[0].name)||n.test(e.categories[0].pluralName)||n.test(e.categories[0].shortName))return e}})},n.shortenResults=function(e,t){return e.slice(0,t)},n.handleCheck=function(e){var t=document.getElementsByClassName("highlight");t&&t.length>0&&Array.prototype.map.call(t,function(e){return e.classList.remove("highlight")}),n.state.checkedId!==e?document.getElementById(e).classList.add("highlight"):e="",n.setState({checkedId:e})},n.infoClosed=function(e){e===n.state.checkedId&&(document.getElementById(n.state.checkedId)&&document.getElementById(n.state.checkedId).classList.remove("highlight"),n.setState({checkedId:""}))},n.state={query:"",tapas:[],tapasShown:[],showLength:10,location:{lat:50.12187,lng:8.68955},checkedId:"",recommend:!1,mapKey:0},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.state.recommend?function(e){var t=new Headers,n={method:"GET",headers:t,mode:"cors",cache:"default"};return t.append("Accept-Language","en"),fetch("".concat("https://api.foursquare.com/v2/venues/explore?","client_id=").concat(b,"&client_secret=").concat(v,"&v=").concat("20181204","&limit=").concat("50","&intent=browse&ll=").concat(e.lat,",").concat(e.lng,"&categoryId=").concat("4d4b7105d754a06374d81259"),n).then(function(e){return e.json()}).catch(function(e){console.log("getBest error, ",e)})}(this.state.location).then(function(t){e.setState({tapas:t.response.groups[0].items},function(){e.addPhotos()})}).catch(function(e){console.log(e)}):w(this.state.location).then(function(t){e.setState({tapas:t.response.venues,tapasShown:e.shortenResults(t.response.venues,e.state.showLength)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement(h.a,{exact:!0,path:"/",render:function(){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement(N,{location:e.state.location,update:e.updateResults}),c.a.createElement(O,{tapas:e.state.tapas,tapasShown:e.state.tapasShown,onNumberUpdate:e.updateTapasShown}),c.a.createElement(j,{recommend:e.state.recommend,tapas:e.state.tapasShown,onCheckedId:e.handleCheck})),c.a.createElement("div",{className:"map-container col-12 col-md-6"},c.a.createElement(I,{key:e.state.mapKey,recommend:e.state.recommend,tapas:e.state.tapasShown,checkedId:e.state.checkedId,handleInfoClose:e.infoClosed})))}}))}}]),t}(o.Component),U=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(c.a.createElement(i.a,null,c.a.createElement(C,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");U?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):A(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):A(t,e)})}}()}},[[17,2,1]]]);
//# sourceMappingURL=main.b4627cbf.chunk.js.map